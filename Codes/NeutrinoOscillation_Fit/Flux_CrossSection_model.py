#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""

"""

import numpy as np
import matplotlib.pyplot as plt

flux_norm = 5
cross_sec_unit = 1.0e-38

# Full flux[]
# Flux[] model ND280, nu_mu, units: neutrinos/(cm2 * 50 MeV * 10e{21} POT)
npoints = 37
Flux = np.full(npoints, 0.0, dtype = np.float32)
E = np.full(npoints, 0.0, dtype=np.float32)
Flux[0]= 0;E[0] = 0.0;
Flux[1]=12752.6;E[1]=0.025
Flux[2]=54387.1;E[2]=0.075
Flux[3]=111899;E[3]=0.125
Flux[4]=177014;E[4]=0.175
Flux[5]=271326;E[5]=0.225
Flux[6]=383862;E[6]=0.275
Flux[7]=496838;E[7]=0.325
Flux[8]=608187;E[8]=0.375
Flux[9]=727225;E[9]=0.425
Flux[10]=897688;E[10]=0.475
Flux[11]=1.12089e+06;E[11]=0.525
Flux[12]=1.24718e+06;E[12]=0.575
Flux[13]=1.24403e+06;E[13]=0.625
Flux[14]=1.16337e+06;E[14]=0.675
Flux[15]=918090;E[15]=0.725
Flux[16]=639182;E[16]=0.775
Flux[17]=422121;E[17]=0.825
Flux[18]=273041;E[18]=0.875
Flux[19]=191366;E[19]=0.925
Flux[20]=141740;E[20]=0.975
Flux[21]=113066;E[21]=1.025
Flux[22]=94186.7;E[22]=1.075
Flux[23]=79511.8;E[23]=1.125
Flux[24]=68091.8;E[24]=1.175
Flux[25]=59903.3;E[25]=1.225
Flux[26]=52537.5;E[26]=1.275
Flux[27]=47631.3;E[27]=1.325
Flux[28]=43095.2;E[28]=1.375
Flux[29]=37878.2;E[29]=1.425
Flux[30]=35544.5;E[30]=1.475
Flux[31]=32223.8;E[31]=1.525
Flux[32]=29583.5;E[32]=1.575
Flux[33]=27201.9;E[33]=1.625
Flux[34]=25170.9;E[34]=1.675
Flux[35]=23294.4;E[35]=1.725
Flux[36]=22417.8;E[36]=1.775
 
plt.plot(E,Flux)
plt.xlabel("E [GeV]")
plt.ylabel("Flux [neutrinos / (cm^2 * 10^21 POT)]")
plt.show()

# Cross section
e = np.full(35, 0.0, dtype = np.float32)
xsec = np.full(35, 0.0, dtype = np.float32)
e[0] = 0.0500000 ; xsec[0] = 0.0043434 ;
e[1] = 0.1000000 ; xsec[1] = 0.0095185 ;
e[2] = 0.1500000 ; xsec[2] = 0.0600886 ;
e[3] = 0.2000000 ; xsec[3] = 0.1056801 ;
e[4] = 0.25 ; xsec[4] = 0.1695939 ;
e[5]= 0.3000000 ; xsec[5] = 0.2345959 ;
e[6] = 0.3499999 ; xsec[6] = 0.2947372 ;
e[7] = 0.4000000 ; xsec[7] = 0.3670271 ;
e[8] = 0.4499999 ; xsec[8] = 0.4433561 ;
e[9] = 0.5 ; xsec[9] = 0.5202292 ;
e[10]= 0.5500000 ; xsec[10] = 0.6077193 ;
e[11] = 0.6000000 ; xsec[11] = 0.6954122 ;
e[12] = 0.6499999 ; xsec[12] = 0.7762684 ;
e[13] = 0.6999999 ; xsec[13] = 0.8575258 ;
e[14] = 0.75 ; xsec[14] = 0.9326797 ;
e[15] = 0.8000000 ; xsec[15] = 1.0019815 ;
e[16] = 0.8500000 ; xsec[16] = 1.0672518 ;
e[17] = 0.8999999 ; xsec[17] = 1.1298935 ;
e[18] = 0.9499999 ; xsec[18] = 1.1924122 ;
e[19] = 1 ;       xsec[19] = 1.2539711 ;
e[20] = 1.0499999 ; xsec[20] = 1.3088034 ;
e[21] = 1.1000000 ; xsec[21] = 1.3625717 ;
e[22] = 1.1499999 ; xsec[22] = 1.4158695 ;
e[23] = 1.2000000 ; xsec[23] = 1.4667800 ;
e[24] = 1.25 ; xsec[24] = 1.5190051 ;
e[25] = 1.2999999 ; xsec[25] = 1.5674283 ;
e[26] = 1.3500000 ; xsec[26] = 1.6186068 ;
e[27] = 1.3999999 ; xsec[27] = 1.6680007 ;
e[28] = 1.4500000 ; xsec[28] = 1.7168169 ;
e[29] = 1.5 ; xsec[29] = 1.7655986 ;
e[30] = 1.5499999 ; xsec[30] = 1.8091367 ;
e[31] = 1.6000000 ; xsec[31] = 1.8526686 ;
e[32] = 1.6499999 ; xsec[32] = 1.8976965 ;
e[33] = 1.7000000 ; xsec[33] = 1.9427199 ;
e[34] = 1.75 ; xsec[34] = 1.9884147 ;
xsec = cross_sec_unit*xsec

#interpolate
plt.plot(e,xsec)
plt.xlabel("E [GeV]")
plt.ylabel("Xsec [cm^-2]")
plt.show()
